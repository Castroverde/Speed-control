-- Made by dagapanis0 [Free to use]
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/bloodball/-back-ups-for-libs/main/random%202"))()
local One = library:Window("Speed Control")

local speedValue = 16 -- Default speed value
local originalSpeed -- Variable to store the original game speed
local enableSpeedControl = false -- Variable to track if speed control is enabled

-- Function to get the player's humanoid
local function getHumanoid()
    local player = game.Players.LocalPlayer
    if player and player.Character and player.Character:FindFirstChild("Humanoid") then
        return player.Character.Humanoid
    end
    return nil
end

-- Function to gradually set the speed
local function gradualSetSpeed(targetSpeed)
    local humanoid = getHumanoid()
    if humanoid then
        local currentSpeed = humanoid.WalkSpeed
        local step = (targetSpeed - currentSpeed) / 50 -- Increase the number of steps for more gradual change
        for i = 1, 50 do
            humanoid.WalkSpeed = humanoid.WalkSpeed + step
            wait(0.1) -- Gradual change with a consistent wait time
        end
    end
end

-- Box for speed input
One:Box("Speed", "Enter speed value", function(value)
    local humanoid = getHumanoid()
    if humanoid then
        local numberValue = tonumber(value)
        if numberValue then
            speedValue = numberValue
            gradualSetSpeed(speedValue)
        end
    end
end)

-- Toggle for enabling/disabling speed control
One:Toggle("Enable Speed Control", function(state)
    local humanoid = getHumanoid()
    if humanoid then
        if state then
            if originalSpeed == nil then
                originalSpeed = humanoid.WalkSpeed -- Store the original speed only once
            end
            enableSpeedControl = true
            gradualSetSpeed(speedValue)

            -- Listen for changes in the humanoid state
            humanoid:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
                if enableSpeedControl then
                    gradualSetSpeed(speedValue)
                end
            end)
        else
            enableSpeedControl = false
            gradualSetSpeed(originalSpeed or 16) -- Reset to original speed or default to 16 if unknown
            originalSpeed = nil -- Reset originalSpeed to allow re-initialization
        end
    end
end)

-- Additional event listeners to prevent speed reset on ability use or being downed
local player = game.Players.LocalPlayer
player.CharacterAdded:Connect(function(character)
    local humanoid = character:WaitForChild("Humanoid")
    humanoid.Died:Connect(function()
        if enableSpeedControl then
            gradualSetSpeed(speedValue)
        end
    end)
end)
